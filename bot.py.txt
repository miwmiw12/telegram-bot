import telebot

TOKEN = '7483145564:AAFi9GtCFOadpKSBRkmJ-dLR6cvqOvnYY9w'  # ØªÙˆÚ©Ù† Ø±Ø¨Ø§Øª Ø´Ù…Ø§
bot = telebot.TeleBot(TOKEN)

# Ø°Ø®ÛŒØ±Ù‡ Ù…ÙˆÙ‚Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
user_data = {}

# Ù…Ø±Ø­Ù„Ù‡ Ø§ÙˆÙ„: Ø¯Ø±ÛŒØ§ÙØª Ù‚Ø¯
@bot.message_handler(commands=['start'])
def ask_height(message):
    chat_id = message.chat.id
    user_data[chat_id] = {'step': 'height'}  # Ø°Ø®ÛŒØ±Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ú©Ø§Ø±Ø¨Ø±
    bot.send_message(chat_id, "Ø³Ù„Ø§Ù…! Ù„Ø·ÙØ§Ù‹ Ù‚Ø¯ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:")

# Ø¯Ø±ÛŒØ§ÙØª Ù‚Ø¯ Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ ÙˆØ²Ù†
@bot.message_handler(func=lambda message: user_data.get(message.chat.id, {}).get('step') == 'height')
def ask_weight(message):
    chat_id = message.chat.id
    try:
        height = int(message.text)
        user_data[chat_id]['height'] = height
        user_data[chat_id]['step'] = 'weight'
        bot.send_message(chat_id, "Ù„Ø·ÙØ§Ù‹ ÙˆØ²Ù† Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù… ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:")
    except ValueError:
        bot.send_message(chat_id, "Ù„Ø·ÙØ§Ù‹ Ø¹Ø¯Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!")

# Ø¯Ø±ÛŒØ§ÙØª ÙˆØ²Ù† Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø³Ù†
@bot.message_handler(func=lambda message: user_data.get(message.chat.id, {}).get('step') == 'weight')
def ask_age(message):
    chat_id = message.chat.id
    try:
        weight = int(message.text)
        user_data[chat_id]['weight'] = weight
        user_data[chat_id]['step'] = 'age'
        bot.send_message(chat_id, "Ù„Ø·ÙØ§Ù‹ Ø³Ù† Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:")
    except ValueError:
        bot.send_message(chat_id, "Ù„Ø·ÙØ§Ù‹ Ø¹Ø¯Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!")

# Ø¯Ø±ÛŒØ§ÙØª Ø³Ù† Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø¹Ú©Ø³
@bot.message_handler(func=lambda message: user_data.get(message.chat.id, {}).get('step') == 'age')
def ask_photo(message):
    chat_id = message.chat.id
    try:
        age = int(message.text)
        user_data[chat_id]['age'] = age
        user_data[chat_id]['step'] = 'photo'
        bot.send_message(chat_id, "Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø¹Ú©Ø³ Ù†ÛŒÙ…â€ŒØ±Ø® Ø§Ø² Ø¨Ø¯Ù† Ø®ÙˆØ¯ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯:")
    except ValueError:
        bot.send_message(chat_id, "Ù„Ø·ÙØ§Ù‹ Ø¹Ø¯Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!")

# Ø¯Ø±ÛŒØ§ÙØª Ø¹Ú©Ø³ Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø¨ÛŒÙ…Ø§Ø±ÛŒ
@bot.message_handler(content_types=['photo'], func=lambda message: user_data.get(message.chat.id, {}).get('step') == 'photo')
def ask_disease(message):
    chat_id = message.chat.id
    user_data[chat_id]['photo'] = message.photo[-1].file_id  # Ø°Ø®ÛŒØ±Ù‡ Ø´Ù†Ø§Ø³Ù‡ Ø¹Ú©Ø³
    user_data[chat_id]['step'] = 'disease'
    bot.send_message(chat_id, "Ø¢ÛŒØ§ Ø¨ÛŒÙ…Ø§Ø±ÛŒ Ø®Ø§ØµÛŒ Ø¯Ø§Ø±ÛŒØ¯ØŸ Ù„Ø·ÙØ§Ù‹ ØªÙˆØ¶ÛŒØ­ Ø¯Ù‡ÛŒØ¯ ÛŒØ§ Ø§Ú¯Ø± Ù†Ø¯Ø§Ø±ÛŒØ¯ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯ 'Ù†Ø¯Ø§Ø±Ù…'.")

# Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒÙ…Ø§Ø±ÛŒ Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ ØºØ°Ø§Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ø¹Ù„Ø§Ù‚Ù‡
@bot.message_handler(func=lambda message: user_data.get(message.chat.id, {}).get('step') == 'disease')
def ask_favorite_food(message):
    chat_id = message.chat.id
    user_data[chat_id]['disease'] = message.text
    user_data[chat_id]['step'] = 'favorite_food'
    bot.send_message(chat_id, "Ù„Ø·ÙØ§Ù‹ Ú†Ù†Ø¯ Ù…ÙˆØ±Ø¯ Ø§Ø² ØºØ°Ø§Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ø¹Ù„Ø§Ù‚Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯:")

# Ø¯Ø±ÛŒØ§ÙØª ØºØ°Ø§Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ø¹Ù„Ø§Ù‚Ù‡ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¬Ù…Ø¹â€ŒØ¨Ù†Ø¯ÛŒ Ø´Ø¯Ù‡
@bot.message_handler(func=lambda message: user_data.get(message.chat.id, {}).get('step') == 'favorite_food')
def summary(message):
    chat_id = message.chat.id
    user_data[chat_id]['favorite_food'] = message.text

    # Ø¬Ù…Ø¹â€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
    summary_text = f"""
    Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù…Ø§:
    ğŸ“ Ù‚Ø¯: {user_data[chat_id]['height']} Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ±
    âš–ï¸ ÙˆØ²Ù†: {user_data[chat_id]['weight']} Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…
    ğŸ§“ Ø³Ù†: {user_data[chat_id]['age']} Ø³Ø§Ù„
    ğŸ¥ Ø¨ÛŒÙ…Ø§Ø±ÛŒ Ø®Ø§Øµ: {user_data[chat_id]['disease']}
    ğŸ½ï¸ ØºØ°Ø§Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ø¹Ù„Ø§Ù‚Ù‡: {user_data[chat_id]['favorite_food']}
    """
    bot.send_message(chat_id, summary_text)

    # Ø§Ø±Ø³Ø§Ù„ Ø¹Ú©Ø³ Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡
    bot.send_photo(chat_id, user_data[chat_id]['photo'])

    # Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø§Ø² Ø­Ø§ÙØ¸Ù‡
    user_data.pop(chat_id, None)

# Ø§Ø¬Ø±Ø§ÛŒ Ø±Ø¨Ø§Øª
bot.polling()
